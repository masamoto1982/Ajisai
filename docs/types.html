<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Types - Ajisai Documentation</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header id="site-header"></header>

    <div class="page-wrapper">
        <aside id="sidebar"></aside>

        <main>
            <h1>Data Types</h1>

            <section>
                <h2>Overview</h2>
                <p>Ajisai recognizes the following data types:</p>
                <ul>
                    <li><strong>Number</strong> - Exact fractions (integers, decimals, rationals)</li>
                    <li><strong>String</strong> - Text enclosed in single quotes</li>
                    <li><strong>Boolean</strong> - TRUE or FALSE</li>
                    <li><strong>Vector</strong> - Ordered collection of values</li>
                    <li><strong>DateTime</strong> - Timestamps with human-readable display</li>
                    <li><strong>Nil</strong> - Absence of value</li>
                    <li><strong>Word</strong> - Named operations</li>
                </ul>
            </section>

            <section>
                <h2>Number</h2>
                <p>All numbers in Ajisai are internally represented as fractions, providing exact arithmetic with no rounding errors.</p>

                <h3>Number Formats</h3>
                <pre><code># Integers
42
-17
0

# Decimals (automatically converted to fractions)
3.14       # Stored as 157/50
0.5        # Stored as 1/2
1.5e2      # Scientific notation: 150

# Fractions
1/3
-2/5
22/7</code></pre>

                <h3>Arithmetic Operations</h3>
                <pre><code>[ 1/3 ] [ 1/6 ] +    # → [ 1/2 ] (exact)
[ 10 ] [ 3 ] /       # → [ 10/3 ] (exact, no rounding)
[ 1/3 ] [ 3 ] *      # → [ 1 ]</code></pre>

                <h3>Rounding Functions</h3>
                <pre><code>[ 7/3 ] FLOOR    # → [ 2 ] (toward negative infinity)
[ 7/3 ] CEIL     # → [ 3 ] (toward positive infinity)
[ 5/2 ] ROUND    # → [ 3 ] (away from zero)</code></pre>
            </section>

            <section>
                <h2>String</h2>
                <p>Strings are sequences of UTF-8 characters enclosed in single quotes.</p>

                <h3>String Literals</h3>
                <pre><code>'hello'
'Hello, World!'
'日本語'          # Full UTF-8 support
''                # Empty string</code></pre>

                <h3>String Operations</h3>
                <pre><code># Split into characters
[ 'hello' ] CHARS     # → [ 'h' 'e' 'l' 'l' 'o' ]

# Join characters
[ 'h' 'e' 'l' 'l' 'o' ] JOIN    # → [ 'hello' ]

# Reverse a string
[ 'hello' ] CHARS REVERSE JOIN   # → [ 'olleh' ]

# String length
[ 'hello' ] CHARS LENGTH    # → [ ... ] [ 5 ]</code></pre>
            </section>

            <section>
                <h2>Boolean</h2>
                <p>Boolean values represent truth values.</p>

                <h3>Boolean Values</h3>
                <pre><code>TRUE
FALSE</code></pre>

                <h3>Comparison Operations</h3>
                <pre><code>[ 3 ] [ 5 ] <      # → [ TRUE ]
[ 3 ] [ 3 ] =      # → [ TRUE ]
[ 5 ] [ 3 ] <=     # → [ FALSE ]</code></pre>

                <h3>Logical Operations</h3>
                <pre><code>[ TRUE ] [ FALSE ] AND    # → [ FALSE ]
[ TRUE ] [ FALSE ] OR     # → [ TRUE ]
[ TRUE ] NOT              # → [ FALSE ]</code></pre>
            </section>

            <section>
                <h2>Vector</h2>
                <p>Vectors are ordered collections that can be nested to represent multi-dimensional data.</p>

                <h3>Vector Creation</h3>
                <pre><code># 1D Vector
[ 1 2 3 ]

# 2D Vector (matrix-like)
[ [ 1 2 ] [ 3 4 ] ]

# Heterogeneous Vector
[ 1 'hello' TRUE [ 2 3 ] ]

# Empty Vector
[ ]</code></pre>

                <h3>Dimension Limits</h3>
                <p>Maximum 4 dimensions are supported:</p>
                <table>
                    <tr>
                        <th>Dim</th>
                        <th>Axes</th>
                        <th>Example</th>
                    </tr>
                    <tr>
                        <td>1D</td>
                        <td>col</td>
                        <td><code>[ 1 2 3 ]</code></td>
                    </tr>
                    <tr>
                        <td>2D</td>
                        <td>row, col</td>
                        <td><code>[ [ 1 2 ] [ 3 4 ] ]</code></td>
                    </tr>
                    <tr>
                        <td>3D</td>
                        <td>layer, row, col</td>
                        <td><code>[ [ [ 1 2 ] [ 3 4 ] ] ]</code></td>
                    </tr>
                    <tr>
                        <td>4D</td>
                        <td>time, layer, row, col</td>
                        <td><code>[ [ [ [ 1 ] ] ] ]</code></td>
                    </tr>
                </table>

                <h3>Shape Operations</h3>
                <pre><code>[ [ 1 2 3 ] [ 4 5 6 ] ] SHAPE      # → [ ... ] [ 2 3 ]
[ [ 1 2 3 ] [ 4 5 6 ] ] RANK       # → [ ... ] [ 2 ]
[ 1 2 3 4 5 6 ] [ 2 3 ] RESHAPE    # → [ [ 1 2 3 ] [ 4 5 6 ] ]
[ [ 1 2 ] [ 3 4 ] ] TRANSPOSE      # → [ [ 1 3 ] [ 2 4 ] ]</code></pre>
            </section>

            <section>
                <h2>DateTime</h2>
                <p>DateTime values represent timestamps with human-readable display.</p>

                <h3>Current Time</h3>
                <pre><code>NOW    # → [ @2024-11-25 14:00:00.500 ]
       # Displayed as datetime, stored as fraction (Unix timestamp)</code></pre>

                <h3>DateTime Conversion</h3>
                <pre><code># Unix timestamp to datetime vector
[ 1732531200 ] 'LOCAL' DATETIME
# → [ [ 2024 11 25 14 0 0 ] ]

# Datetime vector to DateTime type
[ [ 2024 11 25 14 0 0 ] ] 'LOCAL' TIMESTAMP
# → [ @2024-11-25 14:00:00 ]</code></pre>

                <h3>DateTime Arithmetic</h3>
                <pre><code># Add 1 hour (3600 seconds)
NOW [ 3600 ] +    # → [ @2024-11-25 15:00:00 ]

# Time difference
NOW                # Start time
# ... some operations ...
NOW                # End time
-                  # Elapsed seconds</code></pre>
            </section>

            <section>
                <h2>Nil</h2>
                <p>Nil represents the absence of a value.</p>

                <pre><code>nil              # Nil literal
[ 'nil' ] NIL    # Convert string to Nil</code></pre>
            </section>

            <section>
                <h2>Type Conversion</h2>
                <p>Ajisai provides explicit type conversion words:</p>

                <table>
                    <tr>
                        <th>Word</th>
                        <th>Description</th>
                        <th>Example</th>
                    </tr>
                    <tr>
                        <td><code>STR</code></td>
                        <td>Convert to String</td>
                        <td><code>[ 42 ] STR</code> → <code>[ '42' ]</code></td>
                    </tr>
                    <tr>
                        <td><code>NUM</code></td>
                        <td>Convert to Number</td>
                        <td><code>[ '42' ] NUM</code> → <code>[ 42 ]</code></td>
                    </tr>
                    <tr>
                        <td><code>BOOL</code></td>
                        <td>Convert to Boolean</td>
                        <td><code>[ 1 ] BOOL</code> → <code>[ TRUE ]</code></td>
                    </tr>
                    <tr>
                        <td><code>NIL</code></td>
                        <td>Convert to Nil</td>
                        <td><code>[ 'nil' ] NIL</code> → <code>[ nil ]</code></td>
                    </tr>
                    <tr>
                        <td><code>CHARS</code></td>
                        <td>String to character vector</td>
                        <td><code>[ 'abc' ] CHARS</code> → <code>[ 'a' 'b' 'c' ]</code></td>
                    </tr>
                    <tr>
                        <td><code>JOIN</code></td>
                        <td>Character vector to string</td>
                        <td><code>[ 'a' 'b' 'c' ] JOIN</code> → <code>[ 'abc' ]</code></td>
                    </tr>
                </table>

                <h3>Conversion Rules</h3>
                <ul>
                    <li>Same-type conversion is an error (e.g., <code>[ 'text' ] STR</code>)</li>
                    <li><code>TRUE</code> → 1, <code>FALSE</code> → 0</li>
                    <li>1 → <code>TRUE</code>, 0 → <code>FALSE</code></li>
                    <li>Decimals are converted to exact fractions</li>
                </ul>
            </section>

            <section>
                <h2>Broadcasting</h2>
                <p>Ajisai follows NumPy-style broadcasting rules for operations between vectors of different shapes:</p>

                <h3>Scalar Broadcasting</h3>
                <pre><code>[ 5 ] [ 1 2 3 ] +    # → [ 6 7 8 ]</code></pre>

                <h3>Row Broadcasting</h3>
                <pre><code>[ [ 1 2 3 ] [ 4 5 6 ] ] [ 10 20 30 ] +
# → [ [ 11 22 33 ] [ 14 25 36 ] ]</code></pre>

                <h3>Column Broadcasting</h3>
                <pre><code>[ [ 1 2 3 ] [ 4 5 6 ] ] [ [ 100 ] [ 200 ] ] +
# → [ [ 101 102 103 ] [ 204 205 206 ] ]</code></pre>

                <h3>Broadcasting Rules</h3>
                <ol>
                    <li>Shapes are compared from right to left</li>
                    <li>Dimensions are compatible if they are equal or one is 1</li>
                    <li>Missing dimensions are treated as 1</li>
                    <li>Size-1 dimensions are expanded as needed</li>
                </ol>
            </section>
        </main>
    </div>

    <footer id="site-footer"></footer>

    <script src="config.js"></script>
</body>
</html>
