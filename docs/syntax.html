<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Syntax - Ajisai Documentation</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header id="site-header"></header>

    <div class="page-wrapper">
        <aside id="sidebar"></aside>

        <main>
            <h1>Syntax</h1>

            <section>
                <h2>Overview</h2>
                <p>Ajisai uses Reverse Polish Notation (RPN), also known as postfix notation. In RPN, operators follow their operands, eliminating the need for parentheses to define operation order.</p>

                <pre><code># Traditional notation: (1 + 2) * 3
# Ajisai notation:
[ 1 ] [ 2 ] + [ 3 ] *    # Result: [ 9 ]</code></pre>
            </section>

            <section>
                <h2>Basic Elements</h2>

                <h3>Comments</h3>
                <p>Comments start with <code>#</code> and extend to the end of the line:</p>
                <pre><code># This is a comment
[ 1 2 3 ]  # This is also a comment</code></pre>

                <h3>Whitespace</h3>
                <p>Whitespace (spaces, tabs, newlines) separates tokens but is otherwise ignored:</p>
                <pre><code># These are equivalent:
[ 1 2 3 ]
[1 2 3]
[ 1
  2
  3 ]</code></pre>

                <h3>Numbers</h3>
                <p>Numbers can be integers, decimals, or fractions:</p>
                <pre><code>42        # Integer
3.14      # Decimal (stored as fraction internally)
1/3       # Fraction
-5        # Negative number
1.5e2     # Scientific notation (150)</code></pre>

                <h3>Strings</h3>
                <p>Strings are enclosed in single quotes:</p>
                <pre><code>'hello'
'Hello, World!'
'日本語'    # UTF-8 supported</code></pre>

                <h3>Booleans</h3>
                <pre><code>TRUE
FALSE</code></pre>

                <h3>Nil</h3>
                <pre><code>nil</code></pre>
            </section>

            <section>
                <h2>Vectors</h2>
                <p>Vectors are the primary data structure, enclosed in brackets:</p>

                <h3>Creating Vectors</h3>
                <pre><code># 1D Vector
[ 1 2 3 ]

# 2D Nested Vector (matrix-like)
[ [ 1 2 ] [ 3 4 ] ]

# Heterogeneous data
[ 1 'hello' TRUE [ 2 3 ] ]

# Empty vector
[ ]</code></pre>

                <h3>Bracket Types</h3>
                <p>All bracket types (<code>[]</code>, <code>{}</code>, <code>()</code>) are treated equivalently during input:</p>
                <pre><code># These are all equivalent:
[ 1 2 3 ]
{ 1 2 3 }
( 1 2 3 )</code></pre>
                <p>Display uses depth-based bracket styles for readability.</p>
            </section>

            <section>
                <h2>Words</h2>
                <p>Words are named operations. They can be built-in or user-defined:</p>

                <h3>Built-in Words</h3>
                <pre><code>[ 1 2 3 ] [ 4 5 6 ] +     # Addition
[ 1 2 3 ] LENGTH          # Get length
[ 1 2 3 ] REVERSE         # Reverse</code></pre>

                <h3>Defining Custom Words</h3>
                <pre><code># Define a word that doubles a value
[ '[ 2 ] *' ] 'DOUBLE' DEF

# Use the custom word
[ 5 ] DOUBLE              # Result: [ 10 ]</code></pre>

                <h3>Word Names</h3>
                <ul>
                    <li>Can contain letters, numbers, and symbols</li>
                    <li>Case-sensitive</li>
                    <li>Cannot be pure numbers</li>
                    <li>Built-in words cannot be redefined</li>
                </ul>
            </section>

            <section>
                <h2>Operation Targets</h2>
                <p>Ajisai has two operation modes:</p>

                <h3>Stack Top Mode (<code>.</code>)</h3>
                <p>Default mode. Operations apply to the top element of the stack:</p>
                <pre><code>[ 1 2 3 ] . LENGTH    # → [ 1 2 3 ] [ 3 ]
[ 1 2 3 ] LENGTH      # Same (default)</code></pre>

                <h3>Stack Mode (<code>..</code>)</h3>
                <p>Operations apply to the entire stack:</p>
                <pre><code>a b c [ 1 ] .. GET       # Get 1st element from stack
a b c d .. LENGTH        # → a b c d [ 4 ]
a b c .. REVERSE         # → c b a</code></pre>
            </section>

            <section>
                <h2>Guards (Conditional Execution)</h2>
                <p>Guards provide conditional branching using the <code>:</code> word:</p>

                <pre><code># Syntax: condition : action : condition : action : default_action

# Example: Classify a number
[ '[ 0 ] <' ] : [ '[ -1 ] PRINT' ] :
[ '[ 0 ] >' ] : [ '[ 1 ] PRINT' ] :
[ '[ 0 ] PRINT' ]</code></pre>

                <p>Guards are evaluated in order, and the first matching condition's action is executed.</p>
            </section>

            <section>
                <h2>Higher-Order Functions</h2>
                <p>Ajisai supports passing words as arguments:</p>

                <pre><code># MAP - Apply word to each element
[ 1 2 3 ] 'DOUBLE' MAP          # → [ 2 4 6 ]

# FILTER - Keep elements matching condition
[ 1 2 3 4 ] 'IS_EVEN' FILTER    # → [ 2 4 ]

# FOLD - Reduce with initial value
[ 1 2 3 4 ] [ 0 ] '+' FOLD      # → [ 10 ]</code></pre>
            </section>

            <section>
                <h2>Control Flow</h2>

                <h3>TIMES - Repeat Execution</h3>
                <pre><code>'DOUBLE' [ 3 ] TIMES     # Execute DOUBLE 3 times</code></pre>

                <h3>WAIT - Delayed Execution</h3>
                <pre><code>'PROCESS' [ 1000 ] WAIT  # Execute PROCESS after 1000ms</code></pre>
            </section>

            <section>
                <h2>Input Helpers</h2>
                <p>Shortcuts for creating bracket structures:</p>

                <table>
                    <tr>
                        <th>Helper</th>
                        <th>Result</th>
                        <th>Description</th>
                    </tr>
                    <tr>
                        <td><code>SCALAR</code></td>
                        <td><code>[ ]</code></td>
                        <td>1D brackets</td>
                    </tr>
                    <tr>
                        <td><code>VECTOR</code></td>
                        <td><code>[ [ ] ]</code></td>
                        <td>2D brackets</td>
                    </tr>
                    <tr>
                        <td><code>MATRIX</code></td>
                        <td><code>[ [ [ ] ] ]</code></td>
                        <td>3D brackets</td>
                    </tr>
                    <tr>
                        <td><code>TENSOR</code></td>
                        <td><code>[ [ [ [ ] ] ] ]</code></td>
                        <td>4D brackets</td>
                    </tr>
                    <tr>
                        <td><code>'</code></td>
                        <td><code>'</code></td>
                        <td>Single quote input</td>
                    </tr>
                </table>
            </section>

            <section>
                <h2>Example Program</h2>
                <pre><code># Define helper words
[ '[ 2 ] MOD [ 0 ] =' ] 'EVEN?' DEF
[ '[ 2 ] *' ] 'DOUBLE' DEF

# Create a range of numbers
[ 1 ] [ 10 ] RANGE              # → [ 1 2 3 4 5 6 7 8 9 10 ]

# Filter even numbers
'EVEN?' FILTER                   # → [ 2 4 6 8 10 ]

# Double each
'DOUBLE' MAP                     # → [ 4 8 12 16 20 ]

# Sum them up
[ 0 ] '+' FOLD                   # → [ 60 ]</code></pre>
            </section>
        </main>
    </div>

    <footer id="site-footer"></footer>

    <script src="config.js"></script>
</body>
</html>
