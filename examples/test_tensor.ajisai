# Ajisai Tensor Operations Test Suite
# Phase 6: テストの整備

# ============================================================================
# 基本演算テスト（スカラー/ベクタ/行列）
# ============================================================================

# スカラー演算
[ 5 ] [ 3 ] +    # → [ 8 ]
[ 10 ] [ 4 ] -   # → [ 6 ]
[ 6 ] [ 7 ] *    # → [ 42 ]
[ 20 ] [ 4 ] /   # → [ 5 ]

# ベクタ演算
[ 1 2 3 ] [ 4 5 6 ] +              # → [ 5 7 9 ]
[ 10 20 30 ] [ 1 2 3 ] -           # → [ 9 18 27 ]
[ 2 3 4 ] [ 5 6 7 ] *              # → [ 10 18 28 ]
[ 12 15 18 ] [ 3 3 3 ] /           # → [ 4 5 6 ]

# 行列演算
[ [ 1 2 ] [ 3 4 ] ] [ [ 5 6 ] [ 7 8 ] ] +    # → [ [ 6 8 ] [ 10 12 ] ]
[ [ 10 20 ] [ 30 40 ] ] [ [ 1 2 ] [ 3 4 ] ] -  # → [ [ 9 18 ] [ 27 36 ] ]
[ [ 2 3 ] [ 4 5 ] ] [ [ 2 2 ] [ 2 2 ] ] *      # → [ [ 4 6 ] [ 8 10 ] ]

# ============================================================================
# ブロードキャストテスト（様々な形状組み合わせ）
# ============================================================================

# スカラー + ベクタ
[ 5 ] [ 1 2 3 ] +                  # → [ 6 7 8 ]
[ 10 ] [ 2 4 6 8 ] *               # → [ 20 40 60 80 ]

# ベクタ + 行列（行方向ブロードキャスト）
[ [ 1 2 3 ] [ 4 5 6 ] ] [ 10 20 30 ] +
# → [ [ 11 22 33 ] [ 14 25 36 ] ]

[ [ 1 2 3 ] [ 4 5 6 ] ] [ 1 1 1 ] *
# → [ [ 1 2 3 ] [ 4 5 6 ] ]

# 列ベクタ + 行列（列方向ブロードキャスト）
[ [ 1 2 3 ] [ 4 5 6 ] ] [ [ 100 ] [ 200 ] ] +
# → [ [ 101 102 103 ] [ 204 205 206 ] ]

# 1x1行列 + NxM行列
[ [ 1 2 ] [ 3 4 ] ] [ [ 10 ] ] +
# → [ [ 11 12 ] [ 13 14 ] ]

# 形状 [2, 1] + [1, 3] → [2, 3]
[ [ 1 ] [ 2 ] ] [ [ 10 20 30 ] ] +
# → [ [ 11 21 31 ] [ 12 22 32 ] ]

# ============================================================================
# 形状操作テスト（SHAPE/RANK/RESHAPE/TRANSPOSE）
# ============================================================================

# SHAPE - 形状取得
[ 1 2 3 ] SHAPE                     # スタック: [ 1 2 3 ] [ 3 ]
[ [ 1 2 ] [ 3 4 ] ] SHAPE           # スタック: [ [ 1 2 ] [ 3 4 ] ] [ 2 2 ]
[ [ [ 1 2 ] [ 3 4 ] ] [ [ 5 6 ] [ 7 8 ] ] ] SHAPE  # → [ 2 2 2 ]

# RANK - 次元数取得
[ 1 2 3 ] RANK                      # スタック: [ 1 2 3 ] [ 1 ]
[ [ 1 2 ] [ 3 4 ] ] RANK            # スタック: [ [ 1 2 ] [ 3 4 ] ] [ 2 ]
[ [ [ 1 ] ] ] RANK                  # → [ 3 ]

# RESHAPE - 形状変更
[ 1 2 3 4 5 6 ] [ 2 3 ] RESHAPE     # → [ [ 1 2 3 ] [ 4 5 6 ] ]
[ 1 2 3 4 5 6 ] [ 3 2 ] RESHAPE     # → [ [ 1 2 ] [ 3 4 ] [ 5 6 ] ]
[ 1 2 3 4 ] [ 2 2 ] RESHAPE         # → [ [ 1 2 ] [ 3 4 ] ]
[ [ 1 2 ] [ 3 4 ] ] [ 4 ] RESHAPE   # → [ 1 2 3 4 ]

# TRANSPOSE - 転置
[ [ 1 2 3 ] [ 4 5 6 ] ] TRANSPOSE   # → [ [ 1 4 ] [ 2 5 ] [ 3 6 ] ]
[ [ 1 2 ] [ 3 4 ] ] TRANSPOSE       # → [ [ 1 3 ] [ 2 4 ] ]

# LEVEL - 平坦化
[ [ 1 2 ] [ 3 4 ] ] LEVEL           # → [ 1 2 3 4 ]
[ [ [ 1 2 ] [ 3 4 ] ] [ [ 5 6 ] [ 7 8 ] ] ] LEVEL  # → [ 1 2 3 4 5 6 7 8 ]

# ============================================================================
# 複合操作テスト
# ============================================================================

# ベクタを行列に変形して演算
[ 1 2 3 4 ] [ 2 2 ] RESHAPE [ 10 ] *
# → [ [ 10 20 ] [ 30 40 ] ]

# 行列を転置して演算
[ [ 1 2 ] [ 3 4 ] ] TRANSPOSE [ 10 20 ] +
# → [ [ 11 22 ] [ 13 24 ] ]

# 形状を確認しながら演算
[ [ 1 2 3 ] [ 4 5 6 ] ] SHAPE       # → [ 2 3 ]
[ [ 1 2 3 ] [ 4 5 6 ] ] [ 100 ] +   # → [ [ 101 102 103 ] [ 104 105 106 ] ]

# ============================================================================
# エラーケーステスト
# ============================================================================

# 非互換形状のブロードキャスト（エラー）
# [ 1 2 3 ] [ 1 2 ] +               # エラー: [3] + [2] は互換性なし
# [ [ 1 2 3 ] [ 4 5 6 ] ] [ [ 1 2 ] [ 3 4 ] ] +  # エラー: [2,3] + [2,2] は互換性なし

# RESHAPE でサイズ不一致（エラー）
# [ 1 2 3 ] [ 2 2 ] RESHAPE         # エラー: 3要素を4要素の形状に変形不可

# TRANSPOSE で2次元以外（エラー）
# [ 1 2 3 ] TRANSPOSE               # エラー: 1次元テンソルは転置不可

# ============================================================================
# 実数値での検証例
# ============================================================================

# 分数演算が正確に行われることを確認
[ 1 3 ] / [ 1 2 ] /                 # → [ 2/3 ]
[ [ 1 2 ] [ 3 4 ] ] [ 1 3 ] / *     # → [ [ 1/3 2/3 ] [ 1 1/3 ] ]

# 大きな数値でのテスト
[ 999999999 ] [ 1 ] +               # → [ 1000000000 ]
[ 123456789 ] [ 987654321 ] *       # → [ 121932631112635269 ]

# ============================================================================
# パフォーマンステスト用の大規模テンソル
# ============================================================================

# 大きな行列の生成と演算（コメントアウト - 実行時間がかかる）
# [ 0 ] [ 100 ] RANGE [ 10 10 ] RESHAPE [ 1 ] +
